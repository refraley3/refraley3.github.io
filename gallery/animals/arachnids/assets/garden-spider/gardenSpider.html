<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Garden Spider</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="../../../index.html"><img src="../../../Documents/FraleyDesignLogo.png" alt="Fraley Design" width="100"></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#minNav" aria-controls="mainNav" aria-expanded="false" aria-lable="Toggle navigation"><span class="navbar-toggler-icon"></span></button>

                <div class="collapse navbar-collapse" id="mainNav">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link" href="../../../gallery.html">Gallery</a></li>
                        <li class="nav-item"><a class="nav-link" href="../../../birds/birds.html">Birds</a></li>
                        <li class="nav-item"><a class="nav-link" href="../../../fungus/fungus.html">Fungus</a></li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="insectsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Insects</a>
                            <ul class="dropdown-menu" aria-labelledby="insectsDropdown">
                                <li><a class="dropdown-item" href="#">All Insects</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../../bee/bee.html">Bee</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../../butterfly/butterfly.html">Butterfly</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../../damselfly/damselfly.html">Damselfly</a></li>
                                <li><a class="dropdown-item" href="../../dragonfly/dragonfly.html">Dragonfly</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../../fly/fly.html">Fly</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../../grasshopper/grasshopper.html">Grasshopper</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../../moth/moth.html">Moth</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../spider.htmlr</a>
                                    <ul class="dropdown-menu" aria-labelledby="spiderDropdown">
                                        <li><a class="dropdown-item" href="../CrabSpider/crabSpider.html">Crab Spider</a></li>
                                        <li><a class="dropdown-item" href="gardenSpider.html">Garden Spider</a></li>
                                        <li><a class="dropdown-item" href="../Harvestman/harvestman.html">Harvestman</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item"><a class="nav-link" href="../../../places/places.html">Places</a></li>
                        <li class="nav-item"><a class="nav-link" href="../../../plants/plants.html">Plants</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="container py-4">
            <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <div class="hero-slide" style="background-image: url('images/E21A4882-1.jpg');">
                            <h3 class="slide-caption"></h3>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="hero-slide" style="background-image: url('images/E21A4885-1.jpg');">
                            <h3 class="slide-caption"></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container py-4">
            <h2>Garden Spider</h2>
            <div class="row g-3">
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4882.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4882-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4885.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4885-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4890.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4890-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4893.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4893-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4898.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4898-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4901.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4901-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4911.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4911-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4915.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4915-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
                <div class="col-sm-6 col-md-4 col-lg-3">
                    <div class="card bg-dark text-light border-secondary">
                        <h5 class="card-title mb-1 text-center">Black-and-Yellow Garden Spider</h5>
                        <img src="images/E21A4921.jpg" class="card-img-top gallery-img" data-bs-toggle="modal" data-bs-target="#lightboxModal" data-bs-img="images/E21A4921-1.jpg" alt="Black-and-Yellow Garden Spider">
                    </div>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="container">
                <div class="row">
                    <div class="col-md-4 col-12"></div>
                    <div class="col-md-4 col-12">
                        <h3 class="text-center">GET IN TOUCH</h3>
                        <address class="text-center">
                            <strong>Fraley Design, L.L.C.</strong><br>
                            16380 Java Ln<br>
                            Lakeville, MN, 55044, US<br>
                            <abbr title="Phone">P:</abbr> (952) 855-2600
                        </address>
                    </div>
                    <div class="col-md-4 col-12"></div>
                </div>
            </div>
        </div>
        <hr>
        <footer class="text-center">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <p>Copyright © Fraley Design, L.L.C. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </footer>


        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
        <script>
            const lightboxImage = document.getElementById("lightboxImage");
            const galleryImages = document.querySelectorAll(".gallery-img");
            const prevBtn = document.getElementById("prevBtn");
            const nextBtn = document.getElementById("nextBtn");

            const modal = new bootstrap.Modal(document.getElementById("lightboxModal"));

            const modalTitle = document.getElementById("modalTitle");
            const modalText = document.getElementById("modalText");
            const modalExif = document.getElementById("modalExif");

            let currentIndex = 0;

            galleryImages.forEach((img, index) => {
                img.addEventListener("click", () => {
                currentIndex = index;
                updateModalImage();
                });
            });

            function updateModalImage() {
                const img = galleryImages[currentIndex];
                lightboxImage.classList.add("fade-out");

                setTimeout(() => {
                // lightboxImage.src = img.getAttribute("data-bs-img");
                lightboxImage.alt = img.alt;

                // Set caption and title
                const card = img.closest(".card");
                if (card) {
                    const title = card.querySelector(".card-title")?.innerText || "";
                    const caption = card.querySelector(".card-text:last-of-type")?.innerText || "";
                    modalTitle.textContent = title;
                    modalText.textContent = caption;
                }

                // Clear old EXIF and extract new
                modalExif.innerHTML = "";

                // New from CoPilot
                //****************************************************************************
                lightboxImage.onload = () => {
                    const exifImage = new Image();
                    exifImage.crossOrigin = "Anonymous"; // Important for EXIF and CORS
                    exifImage.src = lightboxImage.src;
                    exifImage.onload = () => {
                        EXIF.getData(exifImage, function () {
                            const make = EXIF.getTag(this, "Make") || "Unknown";
                            const model = EXIF.getTag(this, "Model") || "";
                            const iso = EXIF.getTag(this, "ISOSpeedRatings") || "N/A";
                            const fstop = EXIF.getTag(this, "FNumber");
                            const fstopFormatted = fstop ? `f/${fstop.toFixed(1)}` : "N/A";

                // New from CoPilot
                //****************************************************************************
                            const rawShutter = EXIF.getTag(this, "ExposureTime");
                            let shutter = "N/A";

                            if (rawShutter) {
                            if (typeof rawShutter === "number") {
                                shutter = rawShutter < 1
                                ? `1/${Math.round(1 / rawShutter)}`
                                : rawShutter.toFixed(2) + " sec";
                            } else if (typeof rawShutter === "string") {
                                shutter = rawShutter;
                            } else if (typeof rawShutter === "object" && rawShutter.numerator && rawShutter.denominator) {
                                // Handle rational exposureTime object
                                const value = rawShutter.numerator / rawShutter.denominator;
                                shutter = value < 1
                                ? `1/${Math.round(1 / value)}`
                                : value.toFixed(2) + " sec";
                            }
                            }
                //****************************************************************************
                
                            const copyright = EXIF.getTag(this, "Copyright") || "© Ray Fraley";

                            modalExif.innerHTML = `
                            <p class="mb-0"><strong>Camera:</strong> ${make} ${model}</p>
                            <p class="mb-0"><strong>ISO:</strong> ${iso}</p>
                            <p class="mb-0"><strong>Aperture:</strong> ${fstopFormatted}</p>
                            <p class="mb-0"><strong>Shutter:</strong> ${shutter}</p>
                            <p class="mb-0"><strong>Copyright:</strong> ${copyright}</p>
                            `;
                        });
                    };
                };
                //****************************************************************************


                // Force reload by updating src with a cache-busting query string
                const newSrc = img.getAttribute("data-bs-img") + "?v=" + Date.now();
                lightboxImage.src = newSrc;

                lightboxImage.classList.remove("fade-out");
                }, 300);
            }

            prevBtn.addEventListener("click", () => {
                currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
                updateModalImage();
            });

            nextBtn.addEventListener("click", () => {
                currentIndex = (currentIndex + 1) % galleryImages.length;
                updateModalImage();
            });

            // document.addEventListener("keydown", (e) => {
            document.addEventListener("DOMContentLoaded", () => {
                const modalShown = document.getElementById("lightboxModal").classList.contains("show");
                if (!modalShown) return;
                if (e.key === "ArrowLeft") prevBtn.click();
                if (e.key === "ArrowRight") nextBtn.click();
                if (e.key === "Escape") bootstrap.Modal.getInstance(document.getElementById("lightboxModal")).hide();
            });
        </script>

    </body>
</html>